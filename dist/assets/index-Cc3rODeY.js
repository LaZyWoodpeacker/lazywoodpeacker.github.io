var u=Object.defineProperty;var m=(h,t,o)=>t in h?u(h,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):h[t]=o;var n=(h,t,o)=>m(h,typeof t!="symbol"?t+"":t,o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const e of i)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function o(i){const e={};return i.integrity&&(e.integrity=i.integrity),i.referrerPolicy&&(e.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?e.credentials="include":i.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(i){if(i.ep)return;i.ep=!0;const e=o(i);fetch(i.href,e)}})();const d={colors:[{fill:"red",border:"black"},{fill:"blue",border:"black"},{fill:"green",border:"black"}]};class f{constructor(t,o){n(this,"offsetX",0);n(this,"offsetY",0);n(this,"mouseOffsetX",0);n(this,"mouseOffsetY",0);n(this,"maxX",0);n(this,"maxY",0);n(this,"isDragging",!1);n(this,"left",1/0);n(this,"top",1/0);n(this,"width",0);n(this,"height",0);n(this,"collided",!1);n(this,"border");n(this,"objects");this.border=t,this.objects=o,this.offsetX=t.getBoundingClientRect().left,this.offsetY=t.getBoundingClientRect().top;const s=o.reduce((i,e)=>(i.l.push(e.div.getBoundingClientRect().left-this.offsetX),i.r.push(e.div.getBoundingClientRect().right-this.offsetX),i.t.push(e.div.getBoundingClientRect().top-this.offsetY),i.b.push(e.div.getBoundingClientRect().bottom-this.offsetY),i),{l:[],r:[],t:[],b:[]});this.left=Math.min(...s.l),this.top=Math.min(...s.t),this.width=Math.max(...s.r)-this.left,this.height=Math.max(...s.b)-this.top,this.maxX=this.border.offsetWidth-this.width,this.maxY=this.border.offsetHeight-this.height,this.objects.forEach(i=>i.setOnClick(e=>this.onMouseDown(e)).setOffsetX(i.div.getBoundingClientRect().left-this.offsetX-this.left).setOffsetY(i.div.getBoundingClientRect().top-this.offsetY-this.top))}get bottom(){return this.top+this.height}get right(){return this.left+this.width}onMouseDown(t){t.stopPropagation(),this.isDragging=!0,this.mouseOffsetX=t.clientX-this.offsetX-this.left,this.mouseOffsetY=t.clientY-this.offsetY-this.top}setPositionCollide(t,o,s){t=t-this.offsetX-this.mouseOffsetX,o=o-this.offsetY-this.mouseOffsetY;let i=!1,e=!1;return s?(this.bottom<s.top+1||this.top>s.bottom-1?this.left=Math.max(0,Math.min(t,this.maxX)):this.left<s.left?(this.left=Math.max(0,Math.min(t,s.left-this.width)),i=t>s.left-this.width):(this.left=Math.max(s.right,Math.min(t,this.maxX)),i=t<s.right),this.right<s.left+1||this.left>s.right-1?this.top=Math.max(0,Math.min(o,this.maxY)):this.top<s.top?(this.top=Math.max(0,Math.min(o,s.top-this.height)),e=o>s.top-this.height):(this.top=Math.max(s.bottom,Math.min(o,this.maxY)),e=o<s.bottom),this.objects.forEach(r=>{r.setPosition(this.left+r.offsetX,this.top+r.offsetY)}),!!(e||i)):(this.left=Math.max(0,Math.min(t,this.maxX)),this.top=Math.max(0,Math.min(o,this.maxY)),this.objects.forEach(r=>{r.setPosition(this.left+r.offsetX,this.top+r.offsetY)}),!1)}}class a{constructor(t,o){n(this,"div");n(this,"offsetX",0);n(this,"offsetY",0);n(this,"color");n(this,"border");n(this,"onSelected");n(this,"onClick");n(this,"fill");n(this,"stroke");if(this.border=o,this.div=document.getElementById(t),!this.div)throw new Error(`${t} not found`);this.div.addEventListener("mousedown",s=>{s.stopPropagation(),this.onClick&&this.onClick(s),this.onSelected&&this.onSelected(this)})}setSelected(t){return this.onSelected=t,this}setOnClick(t){return this.onClick=t,this}setOffsetX(t){return this.offsetX=t,this}setOffsetY(t){return this.offsetY=t,this}setSize(t){return this.div.style.width=`${t}px`,this.div.style.height=`${t}px`,this}setPosition(t,o){return this.div.style.left=`${t}px`,this.div.style.top=`${o}px`,this}setColor(t){return this.color=t,this.div.style.borderColor=t.border,this.div.style.backgroundColor=t.fill,this}}class g{constructor(){n(this,"select");n(this,"button");n(this,"current");n(this,"buttonClick");this.select=document.getElementById("colorSelector"),this.drawSelect(),this.button=document.getElementById("btn"),this.button.addEventListener("click",()=>{this.buttonClick&&this.buttonClick()})}setOnButtonClick(t){return this.buttonClick=t,this}onSelect(t){this.current=t,this.drawSelect()}drawSelect(){this.select.innerHTML="",d.colors.forEach(t=>{const o=document.createElement("div");o.classList.add("colorSelectItem"),o.style.backgroundColor=t.fill,o.addEventListener("click",()=>{var s;(s=this.current)==null||s.setColor(t)}),this.select.appendChild(o)})}}document.addEventListener("DOMContentLoaded",()=>{const h=document.getElementById("app"),t=new g().setOnButtonClick(()=>{if(e.length===1){const r=new f(h,[s]),l=new f(h,[i]);r.setPositionCollide(r.maxX*Math.random(),r.maxY*Math.random()),l.setPositionCollide(l.maxX*Math.random(),l.maxY*Math.random(),r),e=[r,l]}}),o=r=>{e.forEach(l=>l.objects.forEach(c=>c.div.style.borderStyle=r===c?"dotted":"solid")),t.onSelect(r)},s=new a("squareA",h).setSize(100).setColor(d.colors[0]).setSelected(o).setPosition(100,200),i=new a("squareB",h).setSize(100).setColor(d.colors[1]).setSelected(o).setPosition(350,300);let e=[new f(h,[s]),new f(h,[i])];window.addEventListener("mouseup",()=>{e.forEach(r=>r.isDragging=!1)}),window.addEventListener("mousemove",r=>{if(e.filter(l=>l.isDragging).length){const[l,c]=e[0].isDragging?[e[0],e[1]]:[e[1],e[0]];l.setPositionCollide(r.clientX,r.clientY,c)&&(e=[new f(h,[s,i])])}})});
