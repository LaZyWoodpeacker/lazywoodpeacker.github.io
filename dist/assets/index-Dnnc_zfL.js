var g=Object.defineProperty;var b=(h,t,n)=>t in h?g(h,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):h[t]=n;var r=(h,t,n)=>b(h,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(o){if(o.ep)return;o.ep=!0;const e=n(o);fetch(o.href,e)}})();const c={colors:[{fill:"#e1cdf0",border:"#7819c4"},{fill:"#cdebeb",border:"#1dac9d"},{fill:"#a5d3a5",border:"#2c3f2c"}]};class d{constructor(t,n){r(this,"offsetX",0);r(this,"offsetY",0);r(this,"mouseOffsetX",0);r(this,"mouseOffsetY",0);r(this,"maxX",0);r(this,"maxY",0);r(this,"isDragging",!1);r(this,"left",1/0);r(this,"top",1/0);r(this,"width",0);r(this,"height",0);r(this,"collided",!1);r(this,"border");r(this,"objects");this.border=t,this.objects=n,this.offsetX=t.getBoundingClientRect().left,this.offsetY=t.getBoundingClientRect().top;const i=n.reduce((o,e)=>(o.l.push(e.div.getBoundingClientRect().left-this.offsetX),o.r.push(e.div.getBoundingClientRect().right-this.offsetX),o.t.push(e.div.getBoundingClientRect().top-this.offsetY),o.b.push(e.div.getBoundingClientRect().bottom-this.offsetY),o),{l:[],r:[],t:[],b:[]});this.left=Math.min(...i.l),this.top=Math.min(...i.t),this.width=Math.max(...i.r)-this.left,this.height=Math.max(...i.b)-this.top,this.maxX=this.border.offsetWidth-this.width,this.maxY=this.border.offsetHeight-this.height,this.objects.forEach(o=>o.setOnClick(e=>this.onMouseDown(e)).setOffsetX(o.div.getBoundingClientRect().left-this.offsetX-this.left).setOffsetY(o.div.getBoundingClientRect().top-this.offsetY-this.top))}get bottom(){return this.top+this.height}get right(){return this.left+this.width}onMouseDown(t){t.stopPropagation(),this.isDragging=!0,this.mouseOffsetX=t.clientX-this.offsetX-this.left,this.mouseOffsetY=t.clientY-this.offsetY-this.top}setPositionCollide(t,n,i){t=t-this.offsetX-this.mouseOffsetX,n=n-this.offsetY-this.mouseOffsetY;let o=!1,e=!1;return i?(this.bottom<i.top+1||this.top>i.bottom-1?this.left=Math.max(0,Math.min(t,this.maxX)):this.left<i.left?(this.left=Math.max(0,Math.min(t,i.left-this.width)),o=t>i.left-this.width):(this.left=Math.max(i.right,Math.min(t,this.maxX)),o=t<i.right),this.right<i.left+1||this.left>i.right-1?this.top=Math.max(0,Math.min(n,this.maxY)):this.top<i.top?(this.top=Math.max(0,Math.min(n,i.top-this.height)),e=n>i.top-this.height):(this.top=Math.max(i.bottom,Math.min(n,this.maxY)),e=n<i.bottom),this.objects.forEach(s=>{s.setPosition(this.left+s.offsetX,this.top+s.offsetY)}),!!(e||o)):(this.left=Math.max(0,Math.min(t,this.maxX)),this.top=Math.max(0,Math.min(n,this.maxY)),this.objects.forEach(s=>{s.setPosition(this.left+s.offsetX,this.top+s.offsetY)}),!1)}}class a{constructor(t,n){r(this,"div");r(this,"offsetX",0);r(this,"offsetY",0);r(this,"color");r(this,"border");r(this,"onSelected");r(this,"onClick");r(this,"fill");r(this,"stroke");if(this.border=n,this.div=document.getElementById(t),!this.div)throw new Error(`${t} not found`);this.div.addEventListener("mousedown",i=>{i.stopPropagation(),this.onClick&&this.onClick(i),this.onSelected&&this.onSelected(this)})}setSelected(t){return this.onSelected=t,this}setOnClick(t){return this.onClick=t,this}setOffsetX(t){return this.offsetX=t,this}setOffsetY(t){return this.offsetY=t,this}setSize(t){return this.div.style.width=`${t}px`,this.div.style.height=`${t}px`,this}setPosition(t,n){return this.div.style.left=`${t}px`,this.div.style.top=`${n}px`,this}setColor(t){return this.color=t,this.div.style.borderColor=t.border,this.div.style.backgroundColor=t.fill,this}}class M{constructor(){r(this,"select");r(this,"button");r(this,"current");r(this,"buttonClick");this.select=document.getElementById("colorSelector"),this.setButtonVisible(),this.button=document.getElementById("btn"),this.button.style.display="none",this.button.addEventListener("click",()=>{this.buttonClick&&this.buttonClick()})}setOnButtonClick(t){return this.buttonClick=t,this}setButtonVisible(t=!1){this.button&&(this.button.style.display=t?"flex":"none")}onSelect(t){this.current=t,this.drawSelect()}drawSelect(){this.select.innerHTML="",c.colors.forEach(t=>{const n=document.createElement("div");n.classList.add("colorSelectItem"),n.style.backgroundColor=t.fill,n.style.borderColor=t.border,n.addEventListener("click",()=>{var i;(i=this.current)==null||i.setColor(t)}),this.select.appendChild(n)})}}document.addEventListener("DOMContentLoaded",()=>{const h=document.getElementById("app"),t=new M().setOnButtonClick(()=>{if(e.length===1){const s=new d(h,[i]),l=new d(h,[o]);let[f,u]=s.left<=l.left?[Math.random()*s.left,Math.random()*(l.maxX-l.left)+l.left]:[Math.random()*(s.maxX-s.left)+l.left,Math.random()*l.left],[m,p]=s.top<=l.top?[Math.random()*s.top,Math.random()*(l.maxY-l.top)+l.top]:[Math.random()*(s.maxY-s.top)+s.top,Math.random()*l.top];s.setPositionCollide(f+s.offsetX,m+s.offsetY),l.setPositionCollide(u+l.offsetX,p+l.offsetY),e=[s,l],t.setButtonVisible(!1)}}),n=s=>{e.forEach(l=>l.objects.forEach(f=>f.div.style.borderStyle=s===f?"dotted":"solid")),t.onSelect(s)},i=new a("squareA",h).setSize(100).setColor(c.colors[0]).setSelected(n).setPosition(100,200),o=new a("squareB",h).setSize(100).setColor(c.colors[1]).setSelected(n).setPosition(350,300);let e=[new d(h,[i]),new d(h,[o])];window.addEventListener("mouseup",()=>{e.forEach(s=>s.isDragging=!1)}),window.addEventListener("mousemove",s=>{if(e.filter(l=>l.isDragging).length){const[l,f]=e[0].isDragging?[e[0],e[1]]:[e[1],e[0]];l.setPositionCollide(s.clientX,s.clientY,f)&&(e=[new d(h,[i,o])],e[0].onMouseDown(s),t.setButtonVisible(!0))}})});
